<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>
      {% block title %}
        SDR
      {% endblock %}
    </title>
    <link rel="icon" href="{{ asset('template/images/icon.png') }}" />
    {# Run `composer require symfony/webpack-encore-bundle` to start using Symfony UX #}
    {% block stylesheets %}
      {{ encore_entry_link_tags('app') }}
      <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<link rel="stylesheet" href="{{ asset('template/css/custumselect.css')}}" crossorigin="anonymous"/>
    {% endblock %}

    {% block javascripts %}
      {{ encore_entry_script_tags('app') }}
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   <script src="{{asset('template/js/select2.min.js')}}" defer></script>
    <script>
          $(window).on('load', function() {
            $('.js-example-basic-single').select2();
        });
    </script>
      	<script>
			

function toggleDropdown() {
    var dropdown = document.getElementById("dropdown-menu");
    var arrowIcon = document.getElementById("arrow-icon");
    if (dropdown.style.transform === "scale(0)") {
        dropdown.style.transform = "scale(1)";
        arrowIcon.classList.add("rotate-180");
    } else {
        dropdown.style.transform = "scale(0)";
        arrowIcon.classList.remove("rotate-180");
    }
}

function onChangeLanguage(value)
{

if (value === "fr") {
          window.location.href = "/change/locales/fr";
          } else if (value === "en") {
          window.location.href = "/change/locales/en";
          } else if (value === "ar") {
          window.location.href = "/change/locales/ar";
          }

}
document.addEventListener('DOMContentLoaded', function () {
const searchForm = document.getElementById('search_query');
const searchResults = document.getElementById('search-results');

searchForm.addEventListener('input', function () {
    const query = searchForm.value;

                        if (searchForm && searchForm.value.trim() !== "") {
                        $.ajax({
                                url: '/search/query/'+query,
                                
                                type: "POST",
                                        success: function (response) {

                                        if( response !== null )
                                        {
                                        searchResults.classList.remove('hidden');     
                                        updateResults(response);
                                        }else{
                                                  searchResults.classList.add('hidden'); 
                                                    searchResults.innerHTML = '';
                                               
                                        }
                                               

                                                
                                        },
                                        error: function(jqXHR, textStatus, errorThrown) {
                                        searchResults.classList.add('hidden');     
                                        }
                        });
                        }else{
                                searchResults.classList.add('hidden');     
                                searchResults.innerHTML = '';
                        }
});

function updateResults(results) {
    // Effacez les résultats existants
    searchResults.innerHTML = '';

    // Créez une liste non ordonnée
    const resultList = document.createElement('ul');

    // Ajoutez les nouveaux résultats à la liste
    results.forEach(result => {
        const listItem = document.createElement('li');
        listItem.textContent = result.name; // Utilisez le champ approprié ici
        listItem.classList.add('py-2', 'px-2', 'cursor-pointer','border-b', 'border-gray-100','no-underline');

        // Ajoutez un gestionnaire d'événements pour mettre à jour le champ de recherche
        listItem.addEventListener('click', function () {
            searchForm.value = result.name;
            searchResults.classList.add('hidden');
        });

        resultList.appendChild(listItem);
    });

    // Ajoutez la liste à l'élément searchResults
    searchResults.appendChild(resultList);
}
 document.addEventListener('click', function (event) {
        if (!searchResults.contains(event.target) && event.target !== searchForm) {
            searchResults.classList.add('hidden');
        }
    });
});

</script>
    {% endblock %}
  </head>
  <body>
    {% for message in app.flashes('success') %}
      <div class="p-4 mb-10 text-lg text-white text-center bg-green-400 dark:bg-green-800 dark:text-blue-400 border-b-2 shadow-lg shadow-gray-500/30 border-gray-400" role="alert">{{ message|raw }}</div>
    {% endfor %}
    {% for message in app.flashes('danger') %}
      <div class="p-4 mb-10 text-lg text-white text-center bg-red-400 dark:bg-red-800 dark:text-blue-400 border-b-2 shadow-lg shadow-blue-gray/30 border-gray-400" role="alert">{{ message|raw }}</div>
    {% endfor %}
    {% for message in app.flashes('warning') %}
      <div class="p-4 mb-10 text-lg text-black text-center bg-orange-300 dark:bg-orange-800 dark:text-blue-400 border-b-2 shadow-lg shadow-bgraylue-500/30 border-gray-400" role="alert">{{ message|raw }}</div>
    {% endfor %}
    {{ render(controller('App\\Controller\\MenuController::index')) }}
    {% block body %}
    {% endblock %}
      {% include "components/footer.html.twig" %}
  </body>
</html>
